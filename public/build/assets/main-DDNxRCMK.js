import"./main-DGq6TtTt.js";import{t as e,g as H,s as p,c as j,d as C}from"./helpers-DwlY0Bzp.js";import{i as k,c as N}from"./phoneInput-lwV570lb.js";import{h as R}from"./api-B7h7ZzFK.js";import"./index-xsH4HHeE.js";function V(){const o=window.AppConfig.user,w=document.querySelector("#contact-phone"),n=document.getElementById("contactForm"),r=(o==null?void 0:o.name)||"",f=(o==null?void 0:o.email)||"",b=(o==null?void 0:o.mobile)||"",D=k(w,r),l=N(D,w,n.querySelector('.invalid-feedback[data-field="mobile"]'),e);if(l.setupEventListeners(),window.AppConfig.isAuthenticated){const c=n.querySelector('input[name="name"]'),t=n.querySelector('input[name="email"]'),i=n.querySelector('input[name="mobile"]');c&&!c.value&&r&&(c.value=r),t&&!t.value&&f&&(t.value=f),i&&!i.value&&b&&(i.value=b)}n.addEventListener("submit",async c=>{var v,_,I;if(c.preventDefault(),!H("contact-us")){p("error",{bodyHtml:e("generic_error_try_again"),buttons:[{text:e("close"),class:"my-modal-btn-primary"}],showCloseIcon:!0});return}const t=n.querySelector('button[type="submit"]'),i=t?t.textContent:e("contact_send_button_text");t&&(t.disabled=!0,t.textContent=e("loading_text")),j(n);const m=new FormData(n),u=m.get("mobile");let h=u;if(l){if(u&&u.trim()!==""&&!l.validate()){C(n,{mobile:[e("phone_invalid")]},!0),p("error",{bodyHtml:e("phone_invalid"),buttons:[{text:e("close"),class:"my-modal-btn-primary"}],showCloseIcon:!0}),t&&(t.disabled=!1,t.textContent=i);return}(v=l.getInstance())!=null&&v.isValidNumber()?h=l.getInstance().getNumber():(!u||u.trim()==="")&&(h="")}const M={name:m.get("name"),email:m.get("email"),subject:m.get("subject"),mobile:h,message:m.get("message")};try{const P=(await R({onStatusCodeError:{422:a=>{var E,S,q,F,L;const d=(S=(E=a==null?void 0:a.response)==null?void 0:E.data)==null?void 0:S.message,s=(F=(q=a==null?void 0:a.response)==null?void 0:q.data)==null?void 0:F.errors;let A=e("error_title"),y="",g="";if(s&&Object.keys(s).length>0){C?C(n,s):console.warn("[ContactAction] displayActionFormErrors helper not available to show inline errors."),A=e("validation_error_title"),g=`<ul style="text-align: ${window.AppConfig.isRTL?"right":"left"}; list-style-position: inside; padding-${window.AppConfig.isRTL?"right":"left"}: 0; margin:0;">`;for(const B in s)s[B].forEach(T=>g+=`<li style="margin-bottom: 5px;">${T}</li>`);g+="</ul>",y=e("validation_error_summary")+"<br>"+g}else d?y=d:y=e("generic_error_try_again");t&&(t.disabled=!1,t.textContent=i),(L=p)==null||L("error",{title:A,bodyHtml:y,buttons:[{text:e("close"),class:"my-modal-btn-primary"}],showCloseIcon:!0})}}}).post(H("contact-us"),M)).data;if(t&&(t.disabled=!1,t.textContent=i),(_=p)==null||_("success",{bodyHtml:P.message||e("contact_message_sent_success"),timerSeconds:2,showCloseIcon:!0}),n.reset(),!window.AppConfig.isAuthenticated){const a=n.querySelector('input[name="name"]'),d=n.querySelector('input[name="email"]'),s=n.querySelector('input[name="mobile"]');a&&r&&(a.value=r),d&&f&&(d.value=f),s&&b&&(s.value=b)}}catch(x){console.error("[ContactAction] Contact API error:",x),t&&(t.disabled=!1,t.textContent=i),(I=p)==null||I("error",{bodyHtml:e("network_error"),buttons:[{text:e("close"),class:"my-modal-btn-primary"}],showCloseIcon:!0})}finally{t&&(t.disabled=!1,t.textContent=i)}})}document.addEventListener("DOMContentLoaded",function(){V()});
