import{S as s}from"./main-9Qm2jZ7z.js";import{m as d}from"./module.esm-Cm4okMZt.js";import{g as c,t as r}from"./helpers-DwlY0Bzp.js";import{h as g}from"./api-C5g70RCE.js";import"./index-xsH4HHeE.js";const l=g();function h(){return{isLoading:!0,currentPage:1,ITEMS_PER_PAGE:5,allData:[],paginationData:null,isActionSheetOpen:!1,selectedCategoryId:null,categoryActions:[],init(){this.loadUrlParams(),this.fetchCategories()},openActionSheet(t){this.selectedCategoryId=t,this.categoryActions=[{label:r("edit_tooltip"),icon:"fas fa-edit",classes:"hover:bg-gray-200",handler:()=>this.editItem(this.selectedCategoryId)},{label:r("delete_tooltip"),icon:"fas fa-trash",classes:"text-danger hover:bg-red-100",handler:()=>this.deleteItemWithConfirmation(this.selectedCategoryId)}],this.isActionSheetOpen=!0},async fetchCategories(t=this.currentPage){this.isLoading=!0,document.querySelector("#categoriesDataTable tbody").innerHTML="",document.querySelector("#categoryCardsContainer").innerHTML="",document.querySelector("#paginationInfo").innerHTML="";try{const a=new URLSearchParams({page:t,perPage:this.ITEMS_PER_PAGE}),e=`${c("api.category")}?${a.toString()}`,o=await l.get(e);this.allData=o.data.data,this.paginationData=o.data.pagination,this.currentPage=t,this.updateUrlParams(),this.renderTableAndCards(),this.setupPagination(),this.updatePaginationInfo()}catch(a){console.error("Failed to fetch categories:",a),document.querySelector("#categoriesDataTable tbody").innerHTML=`<tr><td colspan="4" class="text-center p-5 text-danger">${r("error_loading")}</td></tr>`}finally{this.isLoading=!1}},updatePaginationInfo(){const t=document.getElementById("paginationInfo");if(!t||!this.paginationData||this.paginationData.total===0)return;const{from:a,to:e,total:o}=this.paginationData;t.innerHTML=r("pagination_info",{from:a,to:e,total:o})},renderTableAndCards(){const t=document.querySelector("#categoriesDataTable tbody"),a=document.querySelector("#categoryCardsContainer");!t||!a||(t.innerHTML="",a.innerHTML="",this.allData.forEach(e=>{const o=e.image_url||"https://via.placeholder.com/100",n=t.insertRow();n.className="hover:bg-gray-50",n.innerHTML=`
                    <td class="p-4"><img src="${o}" alt="${e.name}" class="w-12 h-12 object-cover rounded-md" /></td>
                    <td class="p-4 font-medium text-text-primary">${e.name||"N/A"}</td>
                    <td class="p-4">${e.created_at||"N/A"}</td>
                    <td class="p-4"><div class="flex items-center justify-center gap-4 text-lg">
                        <button @click.stop="editItem(${e.id})" class="text-accent-primary hover:text-opacity-80" title="${r("edit_tooltip")}"><i class="fas fa-edit"></i></button>
                        <button @click.stop="deleteItemWithConfirmation(${e.id})" class="text-danger hover:text-opacity-80" title="${r("delete_tooltip")}"><i class="fas fa-trash"></i></button>
                    </div></td>`;const i=document.createElement("div");i.className="flex items-center gap-4 p-4 bg-white border rounded-xl shadow-sm border-border-color",i.innerHTML=`
                    <img src="${o}" alt="${e.name}" class="w-16 h-16 rounded-lg object-cover flex-shrink-0">
                    <div class="flex-1 min-w-0">
                        <h3 class="font-bold text-text-primary truncate">${e.name||"N/A"}</h3>
                        <p class="text-sm text-text-secondary"><i class="fas fa-calendar-alt fa-fw me-1"></i>${e.created_at||"N/A"}</p>
                    </div>
                    <button @click="openActionSheet(${e.id})" class="p-2 text-text-secondary hover:text-text-primary -m-2"><i class="fas fa-ellipsis-v"></i></button>`,a.appendChild(i)}))},setupPagination(){const t=document.getElementById("paginationControls");!t||!this.paginationData||!this.paginationData.links||(t.innerHTML="",this.paginationData.links.forEach(a=>{const e=document.createElement("button");e.innerHTML=a.label.replace("«",'<i class="fas fa-angle-left"></i>').replace("»",'<i class="fas fa-angle-right"></i>'),e.disabled=!a.url||a.active;const o="px-3 py-1.5 text-sm rounded-md border transition-colors disabled:opacity-50 disabled:cursor-not-allowed",n=a.active?"bg-accent-primary text-white border-accent-primary":"border-border-color hover:bg-page-bg";e.className=`${o} ${n}`,e.addEventListener("click",()=>{a.url&&this.fetchCategories(new URL(a.url).searchParams.get("page"))}),t.appendChild(e)}))},updateUrlParams(){const t=new URLSearchParams(window.location.search);this.currentPage>1?t.set("page",this.currentPage):t.delete("page"),history.replaceState(null,"",`${window.location.pathname}?${t.toString()}`)},loadUrlParams(){this.currentPage=parseInt(new URLSearchParams(window.location.search).get("page"))||1},editItem(t){window.location.href=c("dashboard.category.edit",{category:t})},deleteItemWithConfirmation(t){s.fire({title:r("confirm_delete_title"),text:r("confirm_delete_text"),icon:"warning",showCancelButton:!0,confirmButtonText:r("confirm_delete_button"),cancelButtonText:r("cancel_button"),confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",reverseButtons:!0}).then(a=>{a.isConfirmed&&this.deleteItem(t)})},async deleteItem(t){var e,o;const a=c("api.category.destroy",{category:t});try{await l.delete(a),s.fire(r("delete_success_title"),r("delete_success_text"),"success"),this.allData.length===1&&this.currentPage>1?this.fetchCategories(this.currentPage-1):this.fetchCategories(this.currentPage)}catch(n){s.fire(r("error_title"),((o=(e=n.response)==null?void 0:e.data)==null?void 0:o.message)||r("delete_error_text",{error:""}),"error")}}}}d.data("categoryList",h);
