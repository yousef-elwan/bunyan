import{S as s}from"./main-9Qm2jZ7z.js";import{g as o,t as n}from"./helpers-DwlY0Bzp.js";import{h as l}from"./api-C5g70RCE.js";import{m as d}from"./module.esm-Cm4okMZt.js";import"./index-xsH4HHeE.js";const c=l();function p(){return{isLoading:!0,currentPage:1,ITEMS_PER_PAGE:5,allTypeData:[],paginationData:null,isActionSheetOpen:!1,selectedTypeId:null,typeActions:[],init(){this.loadUrlParams(),this.fetchTypes()},openActionSheet(t){this.selectedTypeId=t,this.typeActions=[{label:n("edit_tooltip"),icon:"fas fa-edit",classes:"hover:bg-gray-200",handler:()=>this.editType(this.selectedTypeId)},{label:n("delete_tooltip"),icon:"fas fa-trash",classes:"text-danger hover:bg-red-100",handler:()=>this.deleteTypeWithConfirmation(this.selectedTypeId)}],this.isActionSheetOpen=!0},async fetchTypes(t=this.currentPage){this.isLoading=!0,document.querySelector("#typesDataTable tbody").innerHTML="",document.querySelector("#typeCardsContainer").innerHTML="",document.querySelector("#paginationInfo").innerHTML="";try{const e=new URLSearchParams({page:t,perPage:this.ITEMS_PER_PAGE}),a=`${o("api.type")}?${e.toString()}`,i=await c.get(a);this.allTypeData=i.data.data,this.paginationData=i.data.pagination,this.currentPage=t,this.updateUrlParams(),this.renderTableAndCards(),this.setupPagination(),this.updatePaginationInfo()}catch(e){console.error("Failed to fetch types:",e),document.querySelector("#typesDataTable tbody").innerHTML=`<tr><td colspan="4" class="text-center p-5 text-danger">${n("error_loading")}</td></tr>`}finally{this.isLoading=!1}},updatePaginationInfo(){const t=document.getElementById("paginationInfo");if(!t||!this.paginationData||this.paginationData.total===0)return;const{from:e,to:a,total:i}=this.paginationData;t.innerHTML=n("pagination_info",{from:e,to:a,total:i})},renderTableAndCards(){const t=document.querySelector("#typesDataTable tbody"),e=document.querySelector("#typeCardsContainer");!t||!e||(t.innerHTML="",e.innerHTML="",this.allTypeData.forEach(a=>{const i=t.insertRow();i.className="hover:bg-gray-50",i.innerHTML=`
                    <td class="p-4 font-medium text-text-primary">${a.name||"N/A"}</td>
                    <td class="p-4 text-text-secondary">${a.created_at||"N/A"}</td>
                    <td class="p-4"><div class="flex items-center justify-center gap-4 text-lg">
                        <button @click.stop="editType(${a.id})" class="text-accent-primary hover:text-opacity-80" title="${n("edit_tooltip")}"><i class="fas fa-edit"></i></button>
                        <button @click.stop="deleteTypeWithConfirmation(${a.id})" class="text-danger hover:text-opacity-80" title="${n("delete_tooltip")}"><i class="fas fa-trash"></i></button>
                    </div></td>`;const r=document.createElement("div");r.className="flex items-center gap-4 p-4 bg-white border rounded-xl shadow-sm border-border-color",r.innerHTML=`
                    <div class="flex-1 min-w-0">
                        <h3 class="font-bold text-text-primary truncate">${a.name||"N/A"}</h3>
                        <p class="text-xs text-text-secondary mt-1"><i class="fas fa-calendar-alt fa-fw me-1"></i>${a.created_at||"N/A"}</p>
                    </div>
                    <button @click="openActionSheet(${a.id})" class="p-2 text-text-secondary hover:text-text-primary -m-2"><i class="fas fa-ellipsis-v"></i></button>`,e.appendChild(r)}))},setupPagination(){const t=document.getElementById("paginationControls");!t||!this.paginationData||!this.paginationData.links||(t.innerHTML="",this.paginationData.links.forEach(e=>{const a=document.createElement("button");a.innerHTML=e.label.replace("«",'<i class="fas fa-angle-left"></i>').replace("»",'<i class="fas fa-angle-right"></i>'),a.disabled=!e.url||e.active;const i="px-3 py-1.5 text-sm rounded-md border transition-colors disabled:opacity-50 disabled:cursor-not-allowed",r=e.active?"bg-accent-primary text-white border-accent-primary":"border-border-color hover:bg-page-bg";a.className=`${i} ${r}`,a.addEventListener("click",()=>{e.url&&this.fetchTypes(new URL(e.url).searchParams.get("page"))}),t.appendChild(a)}))},updateUrlParams(){const t=new URLSearchParams(window.location.search);this.currentPage>1?t.set("page",this.currentPage):t.delete("page"),history.replaceState(null,"",`${window.location.pathname}?${t.toString()}`)},loadUrlParams(){this.currentPage=parseInt(new URLSearchParams(window.location.search).get("page"))||1},editType(t){window.location.href=o("dashboard.type.edit",{type:t})},deleteTypeWithConfirmation(t){s.fire({title:n("confirm_delete_title"),text:n("confirm_delete_text"),icon:"warning",showCancelButton:!0,confirmButtonText:n("confirm_delete_button"),cancelButtonText:n("cancel_button"),confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",reverseButtons:!0}).then(e=>{e.isConfirmed&&this.deleteType(t)})},async deleteType(t){var e,a;try{await c.delete(o("api.type.destroy",{type:t})),s.fire(n("delete_success_title"),n("delete_success_text"),"success"),this.allTypeData.length===1&&this.currentPage>1?this.fetchTypes(this.currentPage-1):this.fetchTypes(this.currentPage)}catch(i){s.fire(n("error_title"),((a=(e=i.response)==null?void 0:e.data)==null?void 0:a.message)||n("delete_error_text"),"error")}}}}d.data("typeList",p);
