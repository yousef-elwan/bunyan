import{S as s}from"./main-9Qm2jZ7z.js";import{g as i,t as o}from"./helpers-DwlY0Bzp.js";import{h as c}from"./api-2skSE4Ue.js";import{m as d}from"./module.esm-Cm4okMZt.js";import"./index-xsH4HHeE.js";const l=c();function h(){return{isLoading:!0,currentPage:1,ITEMS_PER_PAGE:5,allFloorData:[],paginationData:null,isActionSheetOpen:!1,selectedFloorId:null,floorActions:[],init(){this.loadUrlParams(),this.fetchFloors()},openActionSheet(t){this.selectedFloorId=t,this.floorActions=[{label:o("edit_tooltip"),icon:"fas fa-edit",classes:"hover:bg-gray-200",handler:()=>this.editFloor(this.selectedFloorId)},{label:o("delete_tooltip"),icon:"fas fa-trash",classes:"text-danger hover:bg-red-100",handler:()=>this.deleteFloorWithConfirmation(this.selectedFloorId)}],this.isActionSheetOpen=!0},async fetchFloors(t=this.currentPage){this.isLoading=!0,document.querySelector("#floorsDataTable tbody").innerHTML="",document.querySelector("#floorCardsContainer").innerHTML="",document.querySelector("#paginationInfo").innerHTML="";try{const a=new URLSearchParams({page:t,perPage:this.ITEMS_PER_PAGE}),e=`${i("dashboard.floor.search")}?${a.toString()}`,r=await l.get(e);this.allFloorData=r.data.data,this.paginationData=r.data.pagination,this.currentPage=t,this.updateUrlParams(),this.renderTableAndCards(),this.setupPagination(),this.updatePaginationInfo()}catch(a){console.error("Failed to fetch floors:",a),document.querySelector("#floorsDataTable tbody").innerHTML=`<tr><td colspan="4" class="text-center p-5 text-danger">${o("error_loading")}</td></tr>`}finally{this.isLoading=!1}},updatePaginationInfo(){const t=document.getElementById("paginationInfo");if(!t||!this.paginationData||this.paginationData.total===0)return;const{from:a,to:e,total:r}=this.paginationData;t.innerHTML=o("pagination_info",{from:a,to:e,total:r})},renderTableAndCards(){const t=document.querySelector("#floorsDataTable tbody"),a=document.querySelector("#floorCardsContainer");!t||!a||(t.innerHTML="",a.innerHTML="",this.allFloorData.forEach(e=>{const r=t.insertRow();r.className="hover:bg-gray-50",r.innerHTML=`
                    <td class="p-4 font-medium text-text-primary">${e.name||"N/A"}</td>
                    <td class="p-4 text-text-secondary">${e.value??"N/A"}</td>
                    <td class="p-4 text-text-secondary">${e.created_at||"N/A"}</td>
                    <td class="p-4"><div class="flex items-center justify-center gap-4 text-lg">
                        <button @click.stop="editFloor(${e.id})" class="text-accent-primary hover:text-opacity-80" title="${o("edit_tooltip")}"><i class="fas fa-edit"></i></button>
                        <button @click.stop="deleteFloorWithConfirmation(${e.id})" class="text-danger hover:text-opacity-80" title="${o("delete_tooltip")}"><i class="fas fa-trash"></i></button>
                    </div></td>`;const n=document.createElement("div");n.className="flex items-center gap-4 p-4 bg-white border rounded-xl shadow-sm border-border-color",n.innerHTML=`
                    <div class="flex-1 min-w-0">
                        <h3 class="font-bold text-text-primary truncate">${e.name||"N/A"}</h3>
                        <p class="text-sm text-text-secondary mt-1">
                            <span class="font-semibold">${o("dashboard/floor.list.value")}:</span> ${e.value??"N/A"}
                        </p>
                        <p class="text-xs text-text-secondary mt-1"><i class="fas fa-calendar-alt fa-fw me-1"></i>${e.created_at||"N/A"}</p>
                    </div>
                    <button @click="openActionSheet(${e.id})" class="p-2 text-text-secondary hover:text-text-primary -m-2"><i class="fas fa-ellipsis-v"></i></button>`,a.appendChild(n)}))},setupPagination(){const t=document.getElementById("paginationControls");!t||!this.paginationData||!this.paginationData.links||(t.innerHTML="",this.paginationData.links.forEach(a=>{const e=document.createElement("button");e.innerHTML=a.label.replace("«",'<i class="fas fa-angle-left"></i>').replace("»",'<i class="fas fa-angle-right"></i>'),e.disabled=!a.url||a.active;const r="px-3 py-1.5 text-sm rounded-md border transition-colors disabled:opacity-50 disabled:cursor-not-allowed",n=a.active?"bg-accent-primary text-white border-accent-primary":"border-border-color hover:bg-page-bg";e.className=`${r} ${n}`,e.addEventListener("click",()=>{a.url&&this.fetchFloors(new URL(a.url).searchParams.get("page"))}),t.appendChild(e)}))},updateUrlParams(){const t=new URLSearchParams(window.location.search);this.currentPage>1?t.set("page",this.currentPage):t.delete("page"),history.replaceState(null,"",`${window.location.pathname}?${t.toString()}`)},loadUrlParams(){this.currentPage=parseInt(new URLSearchParams(window.location.search).get("page"))||1},editFloor(t){window.location.href=i("dashboard.floor.edit",{floor:t})},deleteFloorWithConfirmation(t){s.fire({title:o("confirm_delete_title"),text:o("confirm_delete_text"),icon:"warning",showCancelButton:!0,confirmButtonText:o("confirm_delete_button"),cancelButtonText:o("cancel_button"),confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",reverseButtons:!0}).then(a=>{a.isConfirmed&&this.deleteFloor(t)})},async deleteFloor(t){var a,e;try{await l.delete(i("dashboard.floor.destroy",{floor:t})),s.fire(o("delete_success_title"),o("delete_success_text"),"success"),this.allFloorData.length===1&&this.currentPage>1?this.fetchFloors(this.currentPage-1):this.fetchFloors(this.currentPage)}catch(r){s.fire(o("error_title"),((e=(a=r.response)==null?void 0:a.data)==null?void 0:e.message)||o("delete_error_text"),"error")}}}}d.data("floorList",h);
