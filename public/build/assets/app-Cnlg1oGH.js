import{c as g,t as r,d as z,s as D,g as P}from"./helpers-DwlY0Bzp.js";import{i as Y,c as J}from"./phoneInput-C4-BQoBS.js";import{h as V}from"./api-2skSE4Ue.js";import{S as W}from"./main-9Qm2jZ7z.js";import"./index-xsH4HHeE.js";function Q(){const o=document.getElementById("scrollToTopBtn");o&&(window.addEventListener("scroll",function(){window.pageYOffset>200?(o.style.display="block",setTimeout(()=>o.classList.add("show"),10)):(o.classList.remove("show"),setTimeout(()=>{window.pageYOffset<=200&&(o.style.display="none")},300))}),o.addEventListener("click",function(){window.scrollTo({top:0,behavior:"smooth"})}))}function Z(){const o=document.documentElement,B=document.body,A=767,w="notificationsDropdownContentHeader",L="mainAppHeader",_=992;window.setAppDirection=function(e){if(o.getAttribute("dir")===e)return;o.classList.remove("ltr","rtl"),o.classList.add(e),o.setAttribute("dir",e),B.classList.remove("ltr","rtl"),B.classList.add(e),localStorage.setItem("uiDirection",e);const n=new CustomEvent("languageDirectionChanged",{detail:{direction:e}});window.dispatchEvent(n),typeof window.manageLayoutOnResize=="function"&&window.manageLayoutOnResize()};const E=document.getElementById("toggleDirectionBtnExample");E&&E.addEventListener("click",()=>{const e=o.classList.contains("rtl")?"ltr":"rtl";window.setAppDirection(e)});const b=o.getAttribute("dir")||"ltr";B.classList.contains(b)||(B.classList.remove("ltr","rtl"),B.classList.add(b));const u=document.getElementById("mainHamburgerBtn"),F=document.getElementById("mainMobileDrawerNav"),O=document.getElementById("mainDrawerBackdrop"),v=document.getElementById("closeMainMobileDrawerBtn");function I(e){const t=e?"add":"remove";o.classList[t]("drawer-open"),B.classList[t]("drawer-scroll-lock"),u&&u.setAttribute("aria-expanded",e?"true":"false"),F&&F.setAttribute("aria-hidden",e?"false":"true")}u&&u.addEventListener("click",()=>{I(!o.classList.contains("drawer-open"))}),O&&O.addEventListener("click",()=>{I(!1)}),v&&v.addEventListener("click",()=>{I(!1)});const h=document.getElementById("mainNavDrawerContent");if(h){const e=h.querySelectorAll(".drawer-main-menu li.has-submenu-header > a"),t=document.getElementById("drawerNavDivider"),n=h.querySelector(".drawer-main-menu"),i=h.querySelector(".drawer-static-links");t&&n&&n.children.length>0&&i&&i.children.length>0?t.style.display="list-item":t&&(t.style.display="none"),e.forEach(d=>{d.parentElement.querySelector(":scope > ul.drawer-submenu-list")&&d.setAttribute("aria-expanded","false"),d.addEventListener("click",function(y){const T=this.parentElement;if(T.querySelector(":scope > ul.drawer-submenu-list")){y.preventDefault();const M=T.classList.toggle("drawer-submenu-open");this.setAttribute("aria-expanded",M.toString());const q=this.querySelector(".nav-submenu-chevron");q&&q.classList.toggle("active",M)}})})}else console.error("[Drawer Debug] Drawer nav container (#mainNavDrawerContent) NOT found!");function H(e){const t=document.getElementById(L);if(!t||!e)return;const n=t.getBoundingClientRect(),i=10;e.style.position="fixed",e.style.top=`${n.bottom+8}px`,e.style.width=`calc(100vw - ${i*2}px)`,e.style.maxWidth="320px",o.dir==="ltr"?(e.style.left=`${i}px`,e.style.right="auto"):(e.style.right=`${i}px`,e.style.left="auto"),e.dataset.jsPositioned="true"}function x(e){e&&e.dataset.jsPositioned==="true"&&(e.style.position="",e.style.top="",e.style.left="",e.style.right="",e.style.width="",e.style.maxWidth="",delete e.dataset.jsPositioned)}const k=document.getElementById("userProfileMinimalHeader"),C=document.getElementById("userAvatarDropdownHeader"),S=document.getElementById("toggleLangBtnHeader"),N=document.getElementById("langDropdownHeader"),R=document.getElementById("notificationLinkHeader"),$=document.getElementById("notificationsDropdownContentHeader"),j=[C,N,$].filter(Boolean),s=[k,S,R].filter(Boolean);function m(e=null){j.forEach(t=>{if(t!==e&&t.classList.contains("open")){t.classList.remove("open");const n=s.find(i=>i&&(i.getAttribute("aria-controls")===t.id||t.id&&t.id.includes(i.id.replace(/LinkHeader|BtnHeader|ProfileMinimalHeader/,""))));if(n){n.setAttribute("aria-expanded","false");const i=n.querySelector(".lang-chevron");i&&i.classList.remove("dropdown-active"),t.id===w&&t.dataset.jsPositioned==="true"&&x(t)}}})}function a(e,t){!e||!t||(t.id||(t.id=`header-dd-${Math.random().toString(36).substring(2,9)}`),e.setAttribute("aria-controls",t.id),e.addEventListener("click",n=>{n.stopPropagation();const i=!t.classList.contains("open");i&&m(t),t.classList.toggle("open",i),e.setAttribute("aria-expanded",String(i));const d=e.querySelector(".lang-chevron");d&&d.classList.toggle("dropdown-active",i),t.id===w&&(i&&window.innerWidth<=A?setTimeout(()=>{t.classList.contains("open")&&H(t)},10):!i&&t.dataset.jsPositioned==="true"&&x(t))}))}a(k,C),a(S,N),a(R,$),document.addEventListener("click",e=>{let t=!1;j.forEach(n=>{n&&n.contains(e.target)&&(t=!0)}),s.forEach(n=>{n&&n.contains(e.target)&&(t=!0)}),t||m()}),document.addEventListener("keydown",function(e){if(e.key==="Escape"){const t=document.querySelector(".header-dropdown.open");if(t){const n=s.find(i=>i&&i.getAttribute("aria-controls")===t.id);m(),n&&n.focus()}else o.classList.contains("drawer-open")&&(I(!1),u&&u.focus())}}),window.manageLayoutOnResize=function(){window.innerWidth>_&&o.classList.contains("drawer-open")&&I(!1);const e=document.getElementById(w);e&&e.dataset.jsPositioned==="true"&&(window.innerWidth>A?x(e):e.classList.contains("open")&&H(e)),typeof window.updateScrollableTabIndicators=="function"&&window.updateScrollableTabIndicators()},window.addEventListener("resize",window.manageLayoutOnResize),window.manageLayoutOnResize();const l=document.querySelectorAll("#desktopNavStyle1 ul li a");if(l.length>0){const e=window.location.pathname.split("/").pop()||"dashboard.html",t=["dashboard.html","index.html",""];l.forEach(i=>{if(i.classList.remove("active-header-link"),i.closest("li.has-submenu-header")){const d=i.closest("li.has-submenu-header").querySelector(":scope > a");d&&d.classList.remove("active-header-link")}});let n=!1;if(l.forEach(i=>{if(n)return;const d=i.getAttribute("href");if(!d)return;const p=d.split("/").pop();if(p===e||t.includes(e)&&t.includes(p)&&p!==""){i.classList.add("active-header-link"),n=!0;let f=i.closest("li.has-submenu-header");for(;f;){const y=f.querySelector(":scope > a");y&&y.classList.add("active-header-link"),f=f.parentElement.closest("li.has-submenu-header")}}}),!n&&t.includes(e)){const i=document.querySelector('#desktopNavStyle1 ul li a[href="dashboard.html"]');i&&i.classList.add("active-header-link")}}const c=document.querySelectorAll("#mainNavDrawerContent .drawer-main-menu li a");if(c.length>0){const e=window.location.pathname.split("/").pop()||"dashboard.html",t=["dashboard.html","index.html",""];c.forEach(i=>{if(i.classList.remove("active-header-link"),i.closest("li.has-submenu-header")){const p=i.closest("li.has-submenu-header").querySelector(":scope > a");p&&p.classList.remove("active-header-link")}});let n=!1;if(c.forEach(i=>{if(n)return;const d=i.getAttribute("href");if(!d)return;const p=d.split("/").pop();if(p===e||t.includes(e)&&t.includes(p)&&p!==""){i.classList.add("active-header-link"),n=!0;let f=i.closest("li.has-submenu-header");for(;f;){const y=f.querySelector(":scope > a");y&&y.classList.add("active-header-link"),f=f.parentElement.closest("li.has-submenu-header")}}}),!n&&t.includes(e)){const i=document.querySelector('#mainNavDrawerContent .drawer-main-menu li a[href="dashboard.html"]');i&&i.classList.add("active-header-link")}}}function ee(){const o=document.getElementById("openAuthDialogBtn"),B=document.getElementById("closeAuthDialogBtn"),A=document.getElementById("authDialogOverlay"),w=document.querySelector(".login-form"),L=document.querySelector(".register-form"),_=document.querySelector(".toggle-to-register"),E=document.querySelector(".toggle-to-login"),b=document.getElementById("loginForm"),u=document.getElementById("registerForm"),F=document.getElementById("googleLoginBtnLogin"),O=document.getElementById("googleLoginBtnRegister"),v=document.getElementById("agreeTerms"),I=document.getElementById("registerSubmitBtn"),h=document.getElementById("mobileRegisterInput"),H=document.getElementById("logoutButton"),x=Y(h),k=J(x,h,u.querySelector('.invalid-feedback[data-field="mobile"]'),r);k.setupEventListeners();function C(s,m){if(!s)return;const a=s.querySelector(".spinner-border");s.disabled=m,a&&a.classList.toggle("d-none",!m),!m&&s===I&&v&&(s.disabled=!v.checked)}const S=(()=>{function s(){w&&L&&(w.style.transform="translateX(0)",L.style.transform=`translateX(${window.AppConfig.isRTL?"-":""}100%)`)}function m(){A&&(A.classList.add("active"),s(),l(),b&&g&&g(b),u&&g&&g(u),k.resetValidation())}function a(){A&&A.classList.remove("active")}function l(){w&&L&&(w.classList.add("active-form"),w.style.transform="translateX(0)",L.classList.remove("active-form"),L.style.transform=`translateX(${window.AppConfig.isRTL?"-":""}100%)`,b&&g&&g(b),u&&g&&g(u),k.resetValidation())}function c(){w&&L&&(L.classList.add("active-form"),L.style.transform="translateX(0)",w.classList.remove("active-form"),w.style.transform=`translateX(${window.AppConfig.isRTL?"":"-"}100%)`,b&&g&&g(b),u&&g&&g(u),k.resetValidation())}function e(){o&&o.addEventListener("click",m),B&&B.addEventListener("click",a),_&&_.addEventListener("click",t=>{t.preventDefault(),c()}),E&&E.addEventListener("click",t=>{t.preventDefault(),l()})}return{open:m,close:a,showLogin:l,showRegister:c,setupEventListeners:e,setInitialFormPositions:s}})();async function N(s,m){var t;if(m.preventDefault(),!window.AppConfig.csrfToken){D&&D("error",{bodyHtml:r("csrf_error"),title:r("error_title")});return}g&&g(s);const a=s.querySelector(".submit-btn");C(a,!0);const l=new FormData(s);if(s===u){const n=k.getInstance();n&&h&&h.value.trim()!==""?n.isValidNumber()?(l.set("mobile",n.getNumber()),l.set("country_code",n.getSelectedCountryData().dialCode)):console.warn("[AuthModal] Attempting to submit register form with an invalid phone number that passed client pre-check."):h&&h.value.trim()===""&&l.delete("mobile")}const e=(await V({onStatusCodeError:{401:n=>{var f,y,T;const i=(y=(f=n==null?void 0:n.response)==null?void 0:f.data)==null?void 0:y.message;let d=r("error_title"),p="";i&&(p=i),C(a,!1),(T=D)==null||T("error",{title:d,bodyHtml:p,buttons:[{text:r("close"),class:"my-modal-btn-primary"}],showCloseIcon:!0})},422:n=>{var T,U,M,q,X;const i=(U=(T=n==null?void 0:n.response)==null?void 0:T.data)==null?void 0:U.message,d=(q=(M=n==null?void 0:n.response)==null?void 0:M.data)==null?void 0:q.errors;let p=r("error_title"),f="",y="";if(d&&Object.keys(d).length>0){z?z(s,d):console.warn("[AuthModal] displayActionFormErrors helper not available to show inline errors."),p=r("validation_error_title"),y=`<ul style="text-align: ${window.AppConfig.isRTL?"right":"left"}; list-style-position: inside; padding-${window.AppConfig.isRTL?"right":"left"}: 0; margin:0;">`;for(const G in d)d[G].forEach(K=>y+=`<li style="margin-bottom: 5px;">${K}</li>`);y+="</ul>",f=r("validation_error_summary")+"<br>"+y}else i?f=i:f=r("generic_error_try_again");C(a,!1),(X=D)==null||X("error",{title:p,bodyHtml:f,buttons:[{text:r("close"),class:"my-modal-btn-primary"}],showCloseIcon:!0})}}}).post(s.action,l)).data;C(a,!1),(t=D)==null||t("success",{bodyHtml:e.message||r("operation_successful"),title:r("success_title"),showCloseIcon:!0,timerSeconds:1,onClose:n=>{var i;console.log("Timer modal closed. Triggered by UI:",n.triggeredByUiCloseAction,"Config was:",n.config),(i=e.data)!=null&&i.redirect?window.location.href=e.data.redirect:S.close()}})}function R(){b&&b.addEventListener("submit",s=>N(b,s)),u&&u.addEventListener("submit",s=>{let m=!0;const a={},l=[];if(g&&g(u),v&&!v.checked){const c=r("agree_to_terms_required");a.agreeTerms=[c],l.push(c),m=!1}if(h&&h.value.trim()!==""&&!k.validate()){const c=r("phone_invalid");a.mobile=[c],l.push(c),m=!1}if(!m){s.preventDefault(),z&&Object.keys(a).length>0&&z(u,a),D&&l.length>0?D("error",{title:r("validation_error_title"),bodyHtml:l.join("<br>")}):l.length>0&&alert(l.join(`
`)),a.agreeTerms?v==null||v.focus():a.mobile&&(h==null||h.focus());return}N(u,s)})}const $=(()=>{async function s(){var c;const l=(await V().post(P("auth.logout"),{})).data;(c=D)==null||c("success",{bodyHtml:l.message||r("logged_out_successfully"),title:r("logged_out_title")||"Logged Out!",onClose:()=>{var e;return window.location.href=((e=l.data)==null?void 0:e.redirect)||P("home")},buttons:[{text:r("ok_button_text"),class:"my-modal-btn-primary"}],showCloseIcon:!0,timerSeconds:1,onClose:e=>{var t;console.log("Timer modal closed. Triggered by UI:",e.triggeredByUiCloseAction,"Config was:",e.config),window.location.href=((t=l.data)==null?void 0:t.redirect)||P("home")}})}function m(){H&&P("auth.logout")&&D&&H.addEventListener("click",a=>{if(a.preventDefault(),!window.AppConfig.csrfToken){D("error",{title:r("error_title"),bodyHtml:r("csrf_error")});return}D("confirm",{title:r("confirm_logout_title"),bodyHtml:r("confirm_logout_text"),buttons:[{text:r("confirm_logout_yes"),class:"my-modal-btn-danger",onClick:s},{text:r("cancel_button_text"),class:"my-modal-btn-outline"}]})})}return{setupEventListener:m}})(),j=(()=>{function s(){if(v&&I&&u){const c=()=>{I.disabled=!v.checked,v.checked&&g&&g(u,["agreeTerms"])};v.addEventListener("change",c),c()}}function m(){const c=document.documentElement.getAttribute("dir");document.querySelectorAll(".social-login-btn.google-login-btn").forEach(e=>{const t=e.querySelector(".btn-text-login"),n=e.querySelector(".btn-text-register");t&&n&&(t.style.display=c==="rtl"?"inline":"none",n.style.display=c==="rtl"?"none":"inline")})}function a(){[F,O].forEach((c,e)=>{c&&c.addEventListener("click",()=>{const t=e===0?r("google_login_title"):r("google_register_title"),n=r("google_oauth_placeholder");D?D("info",{title:t,bodyHtml:n}):alert(n)})})}function l(){s(),document.querySelector(".social-login-btn.google-login-btn")&&(m(),a())}return{initialize:l}})();A&&(S.setInitialFormPositions(),S.setupEventListeners(),R()),H&&$.setupEventListener(),j.initialize(),S!=null&&S.open&&(window.openAuthDialog=S.open,console.log("[AuthModal] window.openAuthDialog is now available.")),console.log("[AuthModal] Initialization COMPLETE.")}function te(){const o=document.getElementById("newsletterForm");o&&o.addEventListener("submit",async B=>{var L,_;B.preventDefault();const A=document.getElementById("newsletterEmail").value.trim(),w=V({onStatusCodeError:{400:()=>{}}});if(!ne(A)){W.fire({icon:"error",title:"Invalid Email",text:"Please enter a valid email address"});return}try{const E=await w.post(P("newsletter.subscribe"),{email:A});W.fire({icon:"success",title:"Subscription Sent!",text:E.data.message||"Confirmation email has been sent"}),o.reset()}catch(E){const b=((_=(L=E.response)==null?void 0:L.data)==null?void 0:_.message)||"Subscription failed";W.fire({icon:"error",title:"Error",text:b})}})}function ne(o){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o)}function ie(){const o=document.getElementById("swal-success-message");o&&W.fire({icon:"success",title:o.textContent,showConfirmButton:!1,timer:3e3})}ee();Z();Q();te();ie();
